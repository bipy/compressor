# æœ¬é¡¹ç›®åŸºäº imageflow

High-performance image manipulation for web servers. Includes imageflow_server, imageflow_tool, and libimageflow.

é¡¹ç›®åœ°å€ï¼š[imazen/imageflow](https://github.com/imazen/imageflow)

å®˜æ–¹ç½‘ç«™ï¼š[imageflow = libimageflow + imageflow-server](https://www.imageflow.io/)



# åŸºäº imageflow çš„å¤šçº¿ç¨‹å›¾ç‰‡æ‰¹é‡å‹ç¼©è„šæœ¬

imageflow é¢„ç¼–è¯‘çš„ imageflow_tool å¯ä»¥å®ç°å¯¹å›¾ç‰‡è¿›è¡Œé«˜è´¨é‡çš„å‹ç¼©ï¼Œå¯ä»¥åœ¨ä¸æ˜¾è‘—å½±å“å›¾åƒè´¨é‡çš„æƒ…å†µä¸‹å¤§å¹…å‡å°‘å›¾ç‰‡ä½“ç§¯

ä½†åœ¨å¤§é‡å¤„ç†å›¾ç‰‡çš„æƒ…å½¢ä¸‹éœ€è¦è„šæœ¬æ¥å®Œæˆå¹¶è¡Œä¸è‡ªåŠ¨åŒ–å¤„ç†ç­‰åŠŸèƒ½ï¼Œå› æ­¤é€‰æ‹©äº† Go æ¥å®Œæˆå¹¶è¡Œå’Œé€’å½’å¤„ç†åŠŸèƒ½ï¼Œä¸ libimageflow çš„äº¤äº’é€šè¿‡å‘½ä»¤è¡Œå·¥å…· imageflow_tool å®ç°



# åŠŸèƒ½

- ä½¿ç”¨åç¨‹å¹¶è¡Œè°ƒç”¨ imageflow_toolï¼Œå¯è‡ªå®šä¹‰çº¿ç¨‹æ•°
- é€’å½’è®¿é—®è¾“å…¥æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å›¾ç‰‡
- å¯ä»¥æŒ‡å®šè¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥åœ¨å›¾ç‰‡çˆ¶ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆ
- æ”¯æŒ imageflow çš„ä¸»è¦å‚æ•°ï¼Œå¯ç”¨äºè°ƒæ•´ç¼–ç æ ¼å¼ï¼Œè¾“å‡ºå›¾ç‰‡è´¨é‡å’Œæ ¼å¼ï¼Œå›¾ç‰‡å¤§å°ç­‰
- å®Œæ•´æ—¥å¿—ä¿å­˜
- è¾“å‡ºç»Ÿè®¡
- å¼‚å¸¸å¤„ç†
- æ”¯æŒ Windows / Linux / Mac OS ç­‰



# DEMO

ä½œå“åç§°ï¼šã—ã®ã¶ ğŸ¦‹

ä½œå“åœ°å€ï¼š[Pixiv-77458895](https://www.pixiv.net/artworks/77458895)

imageflow ç‰ˆæœ¬ï¼š1.5.0-rc54

è¾“å‡ºæ ¼å¼ï¼šJPG

è¾“å‡ºè´¨é‡å‚æ•°ï¼š90

ä½“ç§¯å‡å°ï¼š85.9% (3,322 KB -> 468 KB)



## åŸå§‹

æ ¼å¼: 3000 Ã— 1688 (PNG, RGBA32)

æ–‡ä»¶ä½“ç§¯: 3.24 MB

![](https://cdn.jsdelivr.net/gh/bipy/CDN@master/repo/Image-Compressor/pid-77458895.png)



## å‹ç¼©å

æ ¼å¼: 3000 Ã— 1688 (JPG, YUV420)

æ–‡ä»¶ä½“ç§¯: 468 KB

![](https://cdn.jsdelivr.net/gh/bipy/CDN@master/repo/Image-Compressor/pid-77458895.jpg)



# ç”¨æ³•

æ³¨æ„ï¼šWindows ä¸‹ä¸æ”¯æŒä¸­æ–‡è·¯å¾„ (**ç»æµ‹è¯•ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬ imageflow ä¸­å·²æ”¯æŒä¸­æ–‡**)

**è§£å†³æ–¹æ³•ï¼š**

1. ä¿®æ”¹ä¸ºè‹±æ–‡è·¯å¾„
2. æ§åˆ¶é¢æ¿ --> æ—¶é’Ÿå’ŒåŒºåŸŸ --> åŒºåŸŸ --> ç®¡ç† --> æ›´æ”¹ç³»ç»ŸåŒºåŸŸè®¾ç½® --> ä½¿ç”¨ Unicode UTF-8 æä¾›å…¨çƒè¯­è¨€æ”¯æŒ



## imageflow å·²çŸ¥ BUG

- ä¸èƒ½å¤„ç†å®½æˆ–é«˜å¤§äº 10000 åƒç´ çš„å›¾ç‰‡
- v1.5.5-rc59 å­˜åœ¨å¤„ç†ææ…¢ï¼ˆè€—æ—¶å‡ åˆ†é’Ÿï¼‰çš„æƒ…å†µï¼Œè¯·é€‰æ‹©å…¶ä»–ç‰ˆæœ¬



## é…ç½®

éœ€ä¸‹è½½ [imageflow Releases](https://github.com/imazen/imageflow/releases) å¹¶é…ç½® imageflow_tool çš„è·¯å¾„



## é»˜è®¤çš„å‚æ•°é…ç½®

å°†å›¾ç‰‡å‹ç¼©ä¸º **jpg** æ ¼å¼

è¾“å‡ºè´¨é‡ **90%**

**ä¸ä¿®æ”¹**å›¾ç‰‡å¤§å°

è‡ªåŠ¨ç”Ÿæˆ ID ä»¥åŒºåˆ†

è‡ªåŠ¨è¾“å‡ºè·¯å¾„ä¸ºçˆ¶çº§ç›®å½•ä¸‹çš„ `INPUT_ID` æ–‡ä»¶å¤¹

ä¿ç•™æ‰€æœ‰å›¾ç‰‡çš„ç›¸å¯¹è·¯å¾„

**egï¼š**è‹¥é…ç½®è¾“å…¥æ–‡ä»¶å¤¹ä¸º`D:\\Pictures`

```
D:\\Pictures\\myimg\\test.png -> D:\\Pictures_231453823\\myimg\\test.jpg
D:\\Pictures\\mypic\\hahaha.png -> D:\\Pictures_231453823\\mypic\\hahaha.jpg
```



## ä¿®æ”¹å‚æ•°

ç›´æ¥ä¿®æ”¹ `config.json` æ–‡ä»¶



## å¯åŠ¨

ä¸‹è½½å¯¹åº” Release å¹¶é…ç½®

```bash
# æ— å‚æ•°ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„ä¸‹çš„ config.json
compressor

# æŒ‡å®šé…ç½®æ–‡ä»¶
compressor -c another_config.json
```



# é…ç½®æ–‡ä»¶è¯´æ˜

|      åç§°      |       å¯é€‰å€¼        |                         è¯´æ˜                         |
| :------------: | :-----------------: | :--------------------------------------------------: |
| imageflow_tool |    imageflow.exe    |                 imageflow_tool è·¯å¾„                  |
|  thread_count  | å°äºCPUæ ¸å¿ƒæ•°çš„ä¸¤å€ |                        çº¿ç¨‹æ•°                        |
|   input_path   |      D:\\in\\       |   è¾“å…¥è·¯å¾„ï¼Œå¿…é¡»æ˜¯æ–‡ä»¶å¤¹ï¼ˆå°†é€’å½’å¤„ç†æ‰€æœ‰å­æ–‡ä»¶å¤¹ï¼‰   |
|  output_path   |      D:\\out\\      | è¾“å‡ºè·¯å¾„ï¼Œè‹¥ä¸æŒ‡å®šé»˜è®¤åœ¨è¾“å…¥è·¯å¾„çˆ¶æ–‡ä»¶å¤¹ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ |
|  output_image  |         {}          |                   å›¾ç‰‡è¾“å‡ºç›¸å…³è®¾ç½®                   |

## å›¾ç‰‡è¾“å‡ºç›¸å…³è®¾ç½®ï¼ˆoutput_imageï¼‰

|     åç§°      | å¯é€‰å€¼  |         è¯´æ˜          |
| :-----------: | :-----: | :-------------------: |
|    quality    | 0\~100  | è¾“å‡ºå›¾ç‰‡è´¨é‡ï¼Œæ¨è 90 |
| output_format | jpg/png |   è¾“å‡ºå›¾ç‰‡ç¼–ç æ ¼å¼    |
|    resize     |   {}    |   å›¾ç‰‡å°ºå¯¸ç›¸å…³è®¾ç½®    |

## å›¾ç‰‡å°ºå¯¸ç›¸å…³è®¾ç½®ï¼ˆresizeï¼‰

|   åç§°    |   å¯é€‰å€¼   |                 è¯´æ˜                 |
| :-------: | :--------: | :----------------------------------: |
|  enable   | true/false |           æ˜¯å¦æ”¹å˜å›¾ç‰‡å°ºå¯¸           |
| resize_by |    0/1     | 0: æŒ‰æŒ‡å®šå®½åº¦ç¼©æ”¾ï¼Œ1: æŒ‰æŒ‡å®šé«˜åº¦ç¼©æ”¾ |
|   width   |    int     |             æŒ‡å®šå›¾ç‰‡å®½åº¦             |
|  height   |    int     |             æŒ‡å®šå›¾ç‰‡é«˜åº¦             |