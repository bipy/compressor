# compressor - 多线程图片批量压缩工具

**jpeg** 可以实现对图片进行高质量的压缩，可以在不显著影响图像质量的情况下大幅减少图片体积

但在大量处理图片的情形下需要完成并行与自动化处理等功能，因此选择了 Go 构建了具备高性能的图片批量处理工具

compressor 可以妥善处理好**将大批量图片压缩成为JPG格式**的任务

# 功能

- 使用协程并行压缩，可自定义线程数
- 递归访问输入文件夹下所有图片
- 可以指定输出文件路径，也可以在图片父目录下自动生成
- 支持调整输出图片质量，输出格式固定为`.jpg`
- 完整日志保存
- 输出统计
- 异常处理
- 跨平台支持

# 用法

## 默认的参数配置

将图片压缩为 **jpg** 格式

输出质量 **90%**

**不修改**图片大小

自动生成 ID 以区分

自动输出路径为父级目录下的 `INPUT_ID` 文件夹

保留所有图片的相对路径

**eg：**若配置输入文件夹为`D:\\Pictures`

```
D:\\Pictures\\myimg\\test.png -> D:\\Pictures_231453823\\myimg\\test.jpg
D:\\Pictures\\mypic\\hahaha.png -> D:\\Pictures_231453823\\mypic\\hahaha.jpg
```



## 修改参数

直接修改 `config.json` 文件



## 启动

下载对应 Release 并配置

```bash
# 无参数，使用相对路径下的 config.json
compressor

# 指定配置文件
compressor -c another_config.json
```



# 配置文件说明

|     名称     |        可选值        |                           说明                           |
| :----------: | :------------------: | :------------------------------------------------------: |
| thread_count | 小于CPU核心数的两倍  |                          线程数                          |
| input_format | "png", "jpg", "jpeg" |             输入图片格式（其他格式将被忽略）             |
|  input_path  |       D:\\in\\       |     输入路径，必须是文件夹（将递归处理所有子文件夹）     |
| output_path  |      D:\\out\\       | 输出路径，若不指定，则默认在输入路径父文件夹下新建文件夹 |
|   quality    |        1～100        |                  输出图片质量，推荐 90                   |
